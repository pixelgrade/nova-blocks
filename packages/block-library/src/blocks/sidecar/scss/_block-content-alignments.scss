.alignfull,
[data-align='full']{
  --block-content-start: fs;
  --block-content-end: fe;
}

.alignwide,
[data-align='wide'] {
  --block-content-start: ws;
  --block-content-end: we;
}

.stop-right,
.stop-right * {
  --block-content-end: ce;
}

.stop-left,
.stop-left * {
  --block-content-start: cs;
}
// Default values used for alignments
.novablocks-sidecar {
  --full-pull-value:  calc(var(--novablocks-final-excess-width) * 0.5);
  --pull-left-value: 0px;
  --pull-right-value: 0px;
}

// ALIGNMENTS
// There are four types of alignments available,
// besides the classic left, right and center.
// 1) Alignfull - This align will help element to break
// out of the container, and make it full screen.
// 2) Wide - This align will help element to break
// out of container, to be slightly bigger than content,
// based on yout settings.
// 3) Pull Right - This align will pull element outside
// of the content on the right side.
// 4) Pul Left - This align will pull element outside
//// of the content on the left side.

// To have more flexibility, our choice for full
// and wide alignments is using negative margins.
// Values used for negative margins,
// are adjusted based on layout type.
// The math behind them should be really simple,
// however, we do not recommend altering them.
// Please keep in mind that this alignments will work,
// as long as there is enough space available on the screen.
// Proceed with caution!

.novablocks-content {
  
  display: block;
  grid-column: var(--block-content-start)/var(--block-content-end);
  position: relative;
  
  > .alignfull {
    margin-left: calc(-1 * Max(0px, var(--pull-left-value)));
    margin-right: calc(-1 * Max(0px, var(--pull-right-value)));
  }
  
  > .alignwide {
    margin-right: calc(-1 * Max(0px, var(--pull-right-value)));
    margin-left: calc(-1 * Max(0px, var(--pull-left-value)));
  }
  
  // Pull Left and Right value are very specific
  // and to reach that level of specificity
  // a lot of classes will be needed. Because of that,
  // we have choose to use !important in this case.
  // Just because, whenever this class exist,
  // we want this CSS to be applied.
  .stop-right,
  .stop-right * {
    --pull-right-value: 0px !important;
  }
  
  .stop-left,
  .stop-left *{
    --pull-left-value: 0px !important;
  }
}

// NO SIDEBAR

.alignfull {
  --pull-left-value: calc((max(var(--wd) * var(--sidebar-left-size-modifier), var(--minimum-sidebar-left-width))) * 0.5 + var(--full-pull-value) + var(--grid-gap));
  --pull-right-value: calc((max(var(--wd) * var(--sidebar-right-size-modifier), var(--minimum-sidebar-right-width))) * 0.5 + var(--full-pull-value) + var(--grid-gap));
}

.alignwide {
  --pull-left-value: calc((max(var(--wd) * var(--sidebar-left-size-modifier), var(--minimum-sidebar-left-width))) * 0.5 + var(--grid-gap));
  --pull-right-value: calc((max(var(--wd) * var(--sidebar-right-size-modifier), var(--minimum-sidebar-right-width))) * 0.5 + var(--grid-gap));
}

.align-pull-right {
  @include pull-align-item(right, true, true);
}

.align-pull-left {
  @include pull-align-item(left, true, true);
}

// RIGHT SIDEBAR
.novablocks-sidecar {
  
  --minimum-sidebar-width: var(--minimum-sidebar-right-width);
  
  .novablocks-content:not(:only-child) {
  
    .alignfull {
      --pull-left-value: var(--full-pull-value);
      --pull-right-value: calc((max(var(--wd) * var(--sidebar-right-size-modifier), var(--minimum-sidebar-right-width))) + var(--full-pull-value) + var(--grid-gap) * 2);
    }
    
    .alignwide {
      --pull-left-value: 0px;
      --pull-right-value: calc(max(var(--wd) * var(--sidebar-right-size-modifier), var(--minimum-sidebar-right-width)) + var(--grid-gap) * 2 );
    }
    
    .align-pull-left {
      @include pull-align-item(left, false, false);
    }
    
    .align-pull-right {
      @include pull-align-item(right, true, false);
    }
    
    .novablocks-block {
      --pull-left-value: 0px;
      --pull-right-value: 0px;
    }
    
    .alignleft {
      --pull-left-value: 0px;
    }
    
    .alignright {
      --pull-right-value: 0px;
    }
  }
}

// LEFT SIDEBAR
.novablocks-sidecar--sidebar-left {
  
  --minimum-sidebar-width: var(--minimum-sidebar-left-width);
  
  .novablocks-content:not(:only-child) {
    
    .alignfull {
      --pull-left-value: calc((max(var(--wd), var(--minimum-sidebar-left-width))) + var(--full-pull-value) + var(--grid-gap) * 2);
      --pull-right-value: var(--full-pull-value);
    }
  
    .alignwide {
      --pull-left-value: calc(max(var(--wd), var(--minimum-sidebar-left-width)) + var(--grid-gap) * 2);
      --pull-right-value: 0px;
    }
  
    .align-pull-left {
      @include pull-align-item(left, true, false);
      
      &.stop-left {
        @include pull-align-item(left, false, false);
      }
    }
  
    .align-pull-right {
      @include pull-align-item(right, false, false);
    }
    
    .alignright {
      --pull-right-value: 0px;
    }
  }
}

// TWO SIDEBARS
.novablocks-sidecar--complex {
  
  .novablocks-content:not(:only-child) {
    
    .alignfull {
      --pull-left-value: calc((max(var(--wd), var(--minimum-sidebar-left-width))) + var(--full-pull-value) + var(--grid-gap) * 2);
      --pull-right-value: calc((max(var(--wd), var(--minimum-sidebar-right-width))) + var(--full-pull-value) + var(--grid-gap) * 2);
    }
    
    .alignwide {
      --pull-left-value: calc(max(var(--wd), var(--minimum-sidebar-left-width)) + var(--grid-gap) * 2);
      --pull-right-value: calc(max(var(--wd), var(--minimum-sidebar-right-width)) + var(--grid-gap) * 2);
    }
  
    .align-pull-left {
      @include pull-align-item(left, true, false);
    }
  
    .align-pull-right {
      @include pull-align-item(right, true, false);
    }
  }
}

// SIDECAR IN SIDECAR
.novablocks-sidecar:not(.ignore-block) {
  
  .novablocks-sidecar--sidebar-left {
    
    .alignfull {
      --pull-left-value: calc((max(var(--wd), var(--minimum-sidebar-left-width))) + var(--full-pull-value) + var(--grid-gap) * 2);
      --pull-right-value: calc((max(var(--wd), var(--minimum-sidebar-right-width))) + var(--full-pull-value) + var(--grid-gap) * 2);
    }
    
    .alignwide {
      --pull-left-value: calc(max(var(--wd), var(--minimum-sidebar-left-width)) + var(--grid-gap) * 2);
      --pull-right-value: calc(max(var(--wd), var(--minimum-sidebar-right-width)) + var(--grid-gap) * 2);
    }
  
    .align-pull-left {
      @include pull-align-item(left, true, false);
      
      &.stop-left {
        @include pull-align-item(left, false, false);
      }
    }
  
    .align-pull-right {
      @include pull-align-item(right, true, false);
      
      &.stop-right {
        @include pull-align-item(right, false, false);
      }
    }
  }
}

.novablocks-content {
  

}


.align-pull-left {
  --minimum-sidebar-width: var(--minimum-sidebar-left-width);
  
  // That means our aligned block is overlapping
  // with blocks from sidebar. In this case, we are going to
  // align pulled block inside the content,
  // exactly as a regular block.
  &[class*='stop'] {
    @include pull-align-item(left, false);
  }
}

.align-pull-right {
  --minimum-sidebar-width: var(--minimum-sidebar-right-width);
  
  // That means our aligned block is overlapping
  // with blocks from sidebar. In this case, we are going to
  // align pulled block inside the content,
  // exactly as a regular block.
  &[class*='stop'] {
    @include pull-align-item(right, false);
  }
}

// @todo: This should not remain in Nova
.novablocks-sidecar:not(.ignore-block) {
  
  .novablocks-sidecar--sidebar-left { 
    
    .novablocks-content {
      grid-column: cs/ce;
    }
  }
}

@include below(lap) {
  .alignwide,
  .alignfull,
  .align-pull-right,
  .align-pull-left {
    --pull-left-value: 0px !important;
    --pull-right-value: 0px !important;
  }
}
